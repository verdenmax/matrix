# 文本分类与排序学习

常设查询 Standing Queries

就是用户经常关注的信息需求，需要寻找这个主题的新内容。此类查询称为常设查询。

常设查询就是一种文本分类器

垃圾邮件过滤，也是一种文本分类的应用。

## 分类

文档d可以怎样表示，可以将d使用分类函数 $\gamma (d) \in C$，将文档所属类别找到。

我们需要构建分类器

- 人工方法，数据规模大时，人工分类困难且代价昂贵。
- 人工编写的基于规则的分类器，建立和维护这些规则非常昂贵
- 监督学习，需要人工分类标记的训练数据

监督学习分类器可以使用各种特征。

在最简的词袋模型中，我们仅使用词项特征。

!!! note "特征选择"

    因为文本语料具有大量的词项

    特征选择可以是的分类器可用，有些分类器无法处理过多特征

    减少训练时间

    使得运行模型小，更快

    提高模型泛化能力

最简单的选择词频特征。

### 朴素贝叶斯分类器

$p(c|d) = \frac{p(d|c)p(c)}{p(d)} \Rightarrow p(d|c)p(c) = p(c) \prod p(t_k | c)$

其中 $p(t_k |c)$ 是在类别c中抽样得到词项 $t_k$ 的概率。即类别c文档的一元语言模型。

$p(t_k|c)$ 的度量是当c是正确类别时 $t_k$ 的贡献。

$argmax_c  p(c|d)$

参数估计：极大似然
    
$p(c) = \frac{N_c}{N}$，$N_c$ 为类c中文档数目，N为所有文档数目

$p(t|c) = \frac{T_{ct}}{\sum_{t^{'} \in V} T_{ct^{'}}}$，其中 $T_{ct}$ 是训练集中类别c中词条t的个数

处理零概率，平滑加1处理。
$p(t|c) = \frac{T_{ct} + 1}{\sum_{t^{'} \in V} (T_{ct^{'}}+1) } = \frac{T_{ct} + 1}{\sum_{t^{'} \in V} T_{ct^{'}}+ |V|}$

朴树贝叶斯，对于训练集的大小和测试文档的大小而言是线性的。


朴素贝叶斯并不朴素。当有很多同等重要的特征时，该方法优于决策树类方法。

如果满足独立性假设，那么朴素贝叶斯是最优的。

## 向量空间分类

Rocchio 分类：

计算每个类的中心向量。
中心向量是所有文档向量的算术平均值。

$\mu(c) = \frac{\sum_{d\in D_c} v(d)}{|D_c|}$

Rocchio 简单地将每个类别表示成其中心向量。分类基于文档向量到原型的相似度或聚类进行。

但是不保证分类结果与训练集一致。

很多情况下 Rocchio 不如朴素贝叶斯，因为 Rocchio 不能处理非凸、多模式类别问题。

## KNN 分类器

K近邻分类器

大多数情况下，KNN的效果比朴素贝叶斯和Rocchio 要好。

k=1，就是将每篇测试文档分类给训练中离它最近的文档所属类别。

k>1,将每篇测试文档分类到训练集中离它最近的k篇文档中所属类别中最多的类别。

KNN基本原理：邻近性假设。

## 线性分类器

计算特征值的线性加权和 $\sum_i w_i \times x_i$ 。

SVM 支持向量机



