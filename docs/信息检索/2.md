# 检索评价

信息检索系统的目标是较小消耗情况下尽快、全面返回准确的结果。

主要考虑效果方面：Effectiveness

## 评价指标

可以将整个文档集合划分为

- Not Retrieved 未检索出
- Retrieved 检索出
- Not Relevant 不相关
- Relevant 相关

那么召回率 Recall ： RR / (RR+NR) 返回的相关结果占总相关结果总数的比率

正确率 Precision： RR / ( RR + RN) 检索出结果中真正相关的结果

一个返回结果集是 RR + RN。 而真正的答案集是 RR + NR。

召回率难以计算，因为数据集比较大，需要人工得到所有的相关结果，这样才可以计算召回率。
所以使用 pooling 方法或者不考虑召回率。
pooling 技术，对多个检索系统的 top k结果组成集合进行人工标注，标注出的相关集合作为整个相关文档集合。

两个指标都是基于无序集合进行计算，并没有考虑排序的作用。

## 将P和R指标进行融合

F值 ：召回率 R 和 正确率P的调和平均值 $F= \frac{2}{\frac{1}{P} + \frac{1}{R}} = \frac{2RP}{P + R}$

$F_{\beta}$： 其中 $\beta$ 表示召回率的重要程度是正确率的 $\beta$ 倍。 $F_{\beta} = \frac{(1 + \beta^2)PR}{P + R}$

E Effectiveness 值：召回率 R 和正确率 P 的加权平均值，b > 1则更重视P。 $E = 1-F_{\beta},b^2 = \frac{1}{\beta^2}$。这里公式: $E = 1 -  \frac{1 +b^2}{\frac{b^2}{P} + \frac{1}{R}}$ 

这里使用调和平均值是因为需要对很小的值进行做出惩罚。类似木桶效应。那么这里调和平均可以看作平滑的最小值函数。


精确率Accuracy ： $accuracy = \frac{RR+NN}{RN+RR+NR+NN}$。对于一个数据量很大，且不相关占比很多的数据，只需要一直返回NULL，就会让精确率很高。因为查询相关文档占文档的极少数。

正确率-召回率曲线：检索结果以排序的方式排列，用户不可能马上看到全部文档。在用户观察的过程中，正确率和召回率在不断变化。可以求出召回率在0，0.1，...，1下正确率，然后描出图像。

这时候又有一个问题，就是召回率有时不是一点点增加，召回率变化幅度很大，那么这时就需要插值。

P—R曲线，简单直观，即考虑了检索结果的覆盖度，又考虑了检索结果的排序情况。缺点： 难以明确表示两个查询的检索结果的优差。

Break Point ： P-R 曲线上P=R的点，这样可以进行单值比较。

AP 平均正确率：对不同召回率点上的正确率进行平均。未插值的AP，计算每个相关文档位置的精确率，若未返回文档到记为0，然后求平均（所有相关文档）。

插值的AP：在召回率0,0.1,0.2,...,1,这11个点上的正确率求平均，等价于11点平均。


## 多个查询进行评价

宏平均：对每个查询求出指标，然后对这些指标进行算术平均。

微平均：将所有查询视为一个查询，将所有情况文档总数求和，然后进行指标计算。（容易收到返回相关文档数目比较大的查询影响。

MAP 对所有查询的AP求宏平均。

还有一些新的评价指标 

Bpref

GMAP

NDCG



